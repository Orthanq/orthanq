{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  
  "config": {
    "axis": {"grid": true, "tickBand": "extent"}
  },
  "datasets": {
    "variants": [],
    "haplotype_variants": [],
    "haplotype_fractions": [],
    "covered_variants": []
  },
  "vconcat":[
    {
      "layer": [
        {
          "data": {"name": "haplotype_variants"},
          "transform": [
            {
              "lookup": "haplotype",
              "from": {
                "data": {"name": "haplotype_fractions"},
                "key": "haplotype",
                "fields": ["fraction"]
              }
            }
          ],
          "mark": "bar",
          "encoding": {
            "x": {"field": "variant", "type": "ordinal"},
            "y": {"aggregate": "sum", "type": "quantitative", "field": "fraction", "axis": {"titleFontSize": 20}},
            "color": {
              "field": "haplotype",
              "type": "nominal",
              "legend": {"titleFontSize": 20, "labelFontSize": 16},
              "scale": {"scheme": "category20"}
            }
          }
        },
        {
          "data": {"name": "variants"},
          "mark": "point",
          "encoding": {
            "x": {"field": "variant", "type": "ordinal", "axis": {"labels": true}},
            "y": {
              "field": "vaf",
              "type": "quantitative",
              "axis": {"titleFontSize": 20, "labelFontSize": 16},
              "scale": {"domain": [0, 1]}
            },
            "color": {"value": "black"}
          }
        }
      ]
  },
  {
    "data": {"name": "haplotype_variants"},
    "mark": "rect",
    "encoding": {
    "y": {"field": "haplotype", "type": "ordinal", "axis": {"titleFontSize": 20, "labelFontSize": 16}},
    "x": {"field": "variant", "type": "ordinal", "axis": {"titleFontSize": 20, "labels": true}},
    "color": {
      "field": "haplotype",
      "scale": {"scheme": "category20"}
    }
    }
  },
  {
    "data": {"name": "covered_variants"},
    "mark": "rect",
    "encoding": {
    "y": {"field": "haplotype", "type": "ordinal", "axis": {"titleFontSize": 20, "labelFontSize": 16}},
    "x": {"field": "variant", "type": "ordinal", "axis": {"titleFontSize": 20, "labels": true}},
    "color": {
      "field": "haplotype",
      "scale": {"scheme": "category20"}
    }
    }
  }
]
}
